

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>One-factor-at-a-time simulations &mdash; PNP Transport 0.1 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/language_data.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Finite Source Simulation Code" href="pnptransport.html" />
    <link rel="prev" title="Welcome to PNP Transport’s documentation!" href="index.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> PNP Transport
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">One-factor-at-a-time simulations</a></li>
<li class="toctree-l1"><a class="reference internal" href="#one-factor-at-a-time-analysis">One-factor-at-a-time analysis</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="pnptransport.html">Finite Source Simulation Code</a></li>
<li class="toctree-l1"><a class="reference internal" href="pnptransport.html#module-pnptransport.infinitesource">Infinite Source Simulation Code</a></li>
<li class="toctree-l1"><a class="reference internal" href="pnptransport.html#module-pnptransport.utils">Utils</a></li>
<li class="toctree-l1"><a class="reference internal" href="pnptransport.html#module-pnptransport.confidence">Confidence Intervals Methods</a></li>
<li class="toctree-l1"><a class="reference internal" href="pnptransport.html#module-pnptransport.transport_storage">Transport HD5 Storage System</a></li>
<li class="toctree-l1"><a class="reference internal" href="pnptransport.html#module-pnptransport.hd5storage">HD5 Storage</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="pidsim.html">Rsh Approximation Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="pidsim.html#module-pidsim.korol_conductivity">Korol Conductivity Implementation</a></li>
<li class="toctree-l1"><a class="reference internal" href="pidsim.html#module-pidsim.parameter_span">Parameter Span</a></li>
<li class="toctree-l1"><a class="reference internal" href="pidsim.html#module-pidsim.conductivity_interface">Conductivty Interface</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">PNP Transport</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>One-factor-at-a-time simulations</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/ofat.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="one-factor-at-a-time-simulations">
<h1>One-factor-at-a-time simulations<a class="headerlink" href="#one-factor-at-a-time-simulations" title="Permalink to this headline">¶</a></h1>
<p>The module <cite>pnptransport.parameter_span</cite> provides functions to multiple input files necessary to simulate the
effect of the variation of a specific parameter.</p>
<p>The following scripts provides an example of the usage:</p>
<div class="literal-block-wrapper docutils container" id="example-of-a-parameter-span">
<div class="code-block-caption"><span class="caption-text">one_factor_at_a_time.py</span><a class="headerlink" href="#example-of-a-parameter-span" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">This program will create all the necessary input files to run pnp transport simulations with &#39;one factor at a time&#39;</span>
<span class="sd">variations.</span>

<span class="sd">The variations on the relevant parameters are described in  pidsim.parameter_span.one_factor_at_a_time documentation.</span>
<span class="sd">These variations are submitted through a csv data file.</span>

<span class="sd">The rest of the parameters are assumed to be constant over all the simulations.</span>

<span class="sd">Besides the input files, the code will generate a database as a csv file with all the simulations to be run and the</span>
<span class="sd">parameters used for each simulation.</span>

<span class="sd">@author: &lt;erickrmartinez@gmail.com&gt;</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pidsim.parameter_span</span> <span class="k">as</span> <span class="nn">pspan</span>

<span class="c1"># The path to the csv file with the conditions of the different variations</span>
<span class="n">csv_file</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;G:\My Drive\Research\PVRD1\Manuscripts\Device_Simulations_draft\simulations\one_factor_at_a_time_lower_20200828_h=1E-12.csv&#39;</span>
<span class="c1"># Simulation time in h</span>
<span class="n">simulation_time_h</span> <span class="o">=</span> <span class="mf">96.</span>
<span class="c1"># Temperature in °C</span>
<span class="n">temperature_c</span> <span class="o">=</span> <span class="mi">85</span>
<span class="c1"># Relative permittivity of SiNx</span>
<span class="n">er</span> <span class="o">=</span> <span class="mf">7.0</span>
<span class="c1"># Thickness of the SiNx um</span>
<span class="n">thickness_sin</span> <span class="o">=</span> <span class="mf">75E-3</span>
<span class="c1"># Modeled thickness of Si um</span>
<span class="n">thickness_si</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="c1"># Number of time steps</span>
<span class="n">t_steps</span> <span class="o">=</span> <span class="mi">720</span>
<span class="c1"># Number of elements in the sin layer</span>
<span class="n">x_points_sin</span> <span class="o">=</span> <span class="mi">100</span>
<span class="c1"># number of elements in the Si layer</span>
<span class="n">x_points_si</span> <span class="o">=</span> <span class="mi">100</span>
<span class="c1"># Background concentration in cm^-3</span>
<span class="n">cb</span> <span class="o">=</span> <span class="mf">1E-20</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">pspan</span><span class="o">.</span><span class="n">one_factor_at_a_time</span><span class="p">(</span>
        <span class="n">csv_file</span><span class="o">=</span><span class="n">csv_file</span><span class="p">,</span> <span class="n">simulation_time</span><span class="o">=</span><span class="n">simulation_time_h</span><span class="o">*</span><span class="mi">3600</span><span class="p">,</span> <span class="n">temperature_c</span><span class="o">=</span><span class="n">temperature_c</span><span class="p">,</span> <span class="n">er</span><span class="o">=</span><span class="n">er</span><span class="p">,</span>
        <span class="n">thickness_sin</span><span class="o">=</span><span class="n">thickness_sin</span><span class="p">,</span> <span class="n">thickness_si</span><span class="o">=</span><span class="n">thickness_si</span><span class="p">,</span> <span class="n">t_steps</span><span class="o">=</span><span class="n">t_steps</span><span class="p">,</span> <span class="n">x_points_sin</span><span class="o">=</span><span class="n">x_points_sin</span><span class="p">,</span>
        <span class="n">x_points_si</span><span class="o">=</span><span class="n">x_points_si</span><span class="p">,</span> <span class="n">base_concentration</span><span class="o">=</span><span class="n">cb</span>
    <span class="p">)</span>
</pre></div>
</td></tr></table></div>
</div>
<p>The script will use the <cite>csv</cite> file defined in <cite>csv_file</cite> which has the following form</p>
<table class="docutils align-default" id="id1">
<caption><span class="caption-text">Parameter Span CSV input</span><a class="headerlink" href="#id1" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 33%" />
<col style="width: 33%" />
<col style="width: 33%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>base</p></th>
<th class="head"><p>span</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>sigma_s</p></td>
<td><p>1.00E+10</p></td>
<td><p>1E10,1E11,1E12,1E13,1E14</p></td>
</tr>
<tr class="row-odd"><td><p>zeta</p></td>
<td><p>1.00E-04</p></td>
<td><p>1E-8, 1E-7, 1E-6, 1E-5,1E-4</p></td>
</tr>
<tr class="row-even"><td><p>DSF</p></td>
<td><p>1.00E-14</p></td>
<td><p>1E-14,1E-15,1E-16</p></td>
</tr>
<tr class="row-odd"><td><p>E</p></td>
<td><p>1.00E+04</p></td>
<td><p>1E1,1E2,1E3,1E4,1E5,1E6</p></td>
</tr>
<tr class="row-even"><td><p>m</p></td>
<td><p>1.00E+00</p></td>
<td><p>1</p></td>
</tr>
<tr class="row-odd"><td><p>h</p></td>
<td><p>1.00E-12</p></td>
<td><p>1E-12,1E-10,1E-8</p></td>
</tr>
<tr class="row-even"><td><p>recovery time</p></td>
<td><p>43200</p></td>
<td><p>43200</p></td>
</tr>
<tr class="row-odd"><td><p>recovery electric field</p></td>
<td><p>-1.00E+04</p></td>
<td><p>-1.00E+04</p></td>
</tr>
</tbody>
</table>
<p><strong>sigma_s</strong> corresponds to the surface concentration at the source <span class="math notranslate nohighlight">\(S\)</span> in cm<sup>-2</sup> , <strong>zeta</strong> corresponds
to the rate of ingress from the source <span class="math notranslate nohighlight">\(k\)</span> in s<sup>-1</sup> , <strong>DSF</strong> is the diffusivity of Na in the stacking
fault <span class="math notranslate nohighlight">\(D_{\mathrm{SF}}\)</span> in cm<sup>2</sup>/s, <strong>E</strong> is the electric field in SiN<sub>x</sub>given in V/cm, h and m
are the surface mass transfer coefficient (cm/s) and segregation coefficient at the SiN<sub>x</sub>/Si interface,
respectively. The <strong>recovery time</strong> is indicated in seconds and corresponds to time added to the simulation where
the system is either (1) allowed to relax by removing the electric stress or, (2) stressed under the PID stress in
reverse polarity. The value of the recovery electric field is indicated in the last row of the table.</p>
<p>The column <em>base</em> corresponds to the base case to compare the rest of the simulations. The span column indicates
all the variations from the base case for the respective parameter in the row, while keeping the rest of the parameters
constant.</p>
<p>After running the code, the following file structure will be created</p>
<p>which will generate a folder structure like this.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">base_folder</span>
<span class="o">|---</span><span class="n">one_factor_at_a_time</span><span class="o">.</span><span class="n">csv</span>
<span class="o">|---</span><span class="nb">input</span>
<span class="o">|</span>   <span class="o">|---</span><span class="n">constant_source_flux_96_85C_1E</span><span class="o">+</span><span class="mi">10</span><span class="n">pcm2_z1E</span><span class="o">-</span><span class="mi">04</span><span class="n">ps_DSF1E</span><span class="o">-</span><span class="mf">14_1E+01</span><span class="n">Vcm_h1E</span><span class="o">-</span><span class="mi">12</span><span class="n">_m1E</span><span class="o">+</span><span class="mi">00</span><span class="n">_rt12h_rv</span><span class="o">-</span><span class="mf">1E+01</span><span class="n">Vcm</span><span class="o">.</span><span class="n">ini</span>
<span class="o">|</span>   <span class="o">|---</span><span class="n">constant_source_flux_96_85C_1E</span><span class="o">+</span><span class="mi">10</span><span class="n">pcm2_z1E</span><span class="o">-</span><span class="mi">04</span><span class="n">ps_DSF1E</span><span class="o">-</span><span class="mf">14_1E+02</span><span class="n">Vcm_h1E</span><span class="o">-</span><span class="mi">12</span><span class="n">_m1E</span><span class="o">+</span><span class="mi">00</span><span class="n">_rt12h_rv</span><span class="o">-</span><span class="mf">1E+02</span><span class="n">Vcm</span><span class="o">.</span><span class="n">ini</span>
<span class="o">|</span>   <span class="o">|---</span> <span class="o">...</span>
<span class="o">|</span>   <span class="o">|---</span><span class="n">ofat_db</span><span class="o">.</span><span class="n">csv</span>
<span class="o">|</span>   <span class="o">|---</span><span class="n">batch_YYYYMMDD</span><span class="o">.</span><span class="n">sh</span>
</pre></div>
</div>
<p>With <span class="math notranslate nohighlight">\(n\)</span> .ini files corresponding to all of the variations. The naming convention for the .ini files is
<cite>constant_source_flux_</cite> + PID stress time in hours + <cite>_</cite> + <span class="math notranslate nohighlight">\(T\)</span> in °C + <cite>C_</cite> + <span class="math notranslate nohighlight">\(S\)</span>
in cm<sup>-2</sup>+ <cite>pcm2_z</cite> + <span class="math notranslate nohighlight">\(k\)</span> in s<sup>-1</sup> + <cite>ps_DSF</cite> + <span class="math notranslate nohighlight">\(D_{\mathrm{SF}}\)</span> in
cm<sup>2</sup>/s + <cite>_</cite> + <span class="math notranslate nohighlight">\(E\)</span> in V/cm + <cite>_h</cite> + <span class="math notranslate nohighlight">\(h\)</span> in cm/s + <cite>_m</cite> + <span class="math notranslate nohighlight">\(m\)</span> + <cite>_rt</cite> +
recovery time in hours + <cite>h_rv</cite> + recovery voltage (at the SiN<sub>x</sub>) in V/cm.</p>
<p>Additionally, the scripts create a batch script <cite>batch_YYYYMMDD.sh</cite> that needs to be run in the location where
<cite>simulate_fs.py</cite> can be reached. This will send all the simulations as separate python jobs to the OS.</p>
<p>Lastly, the script generates a <cite>ofat_db.csv</cite> table containing the list of all simulations with all the parameters
used in each case:</p>
<table class="docutils align-default" id="id2">
<caption><span class="caption-text">OFAT Database</span><a class="headerlink" href="#id2" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 5%" />
<col style="width: 5%" />
<col style="width: 5%" />
<col style="width: 5%" />
<col style="width: 5%" />
<col style="width: 5%" />
<col style="width: 5%" />
<col style="width: 5%" />
<col style="width: 5%" />
<col style="width: 5%" />
<col style="width: 5%" />
<col style="width: 5%" />
<col style="width: 5%" />
<col style="width: 5%" />
<col style="width: 5%" />
<col style="width: 5%" />
<col style="width: 5%" />
<col style="width: 5%" />
<col style="width: 5%" />
<col style="width: 5%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>config file</p></th>
<th class="head"><p>sigma_s (cm^-2)</p></th>
<th class="head"><p>zeta (1/s)</p></th>
<th class="head"><p>D_SF (cm^2/s)</p></th>
<th class="head"><p>E (V/cm)</p></th>
<th class="head"><p>h (cm/s)</p></th>
<th class="head"><p>m</p></th>
<th class="head"><p>time (s)</p></th>
<th class="head"><p>temp (C)</p></th>
<th class="head"><p>bias (V)</p></th>
<th class="head"><p>recovery time (s)</p></th>
<th class="head"><p>recovery E (V/cm)</p></th>
<th class="head"><p>recovery  bias (V)</p></th>
<th class="head"><p>thickness sin (um)</p></th>
<th class="head"><p>thickness si (um)</p></th>
<th class="head"><p>er</p></th>
<th class="head"><p>cb (cm^-3)</p></th>
<th class="head"><p>t_steps</p></th>
<th class="head"><p>x_points sin</p></th>
<th class="head"><p>x_points si</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>constant_source_flux_96_85C_1E+10pcm2_z1E-04ps_DSF1E-14_1E+04Vcm_h1E-12_m1E+00_rt12h_rv-1E+04Vcm.ini</p></td>
<td><p>10000000000</p></td>
<td><p>0.0001</p></td>
<td><p>1.00E-14</p></td>
<td><p>10000</p></td>
<td><p>1.00E-12</p></td>
<td><p>1</p></td>
<td><p>345600</p></td>
<td><p>85</p></td>
<td><p>0.075</p></td>
<td><p>43200</p></td>
<td><p>-10000</p></td>
<td><p>-0.075</p></td>
<td><p>0.075</p></td>
<td><p>1</p></td>
<td><p>7</p></td>
<td><p>1.00E-20</p></td>
<td><p>720</p></td>
<td><p>100</p></td>
<td><p>100</p></td>
</tr>
<tr class="row-odd"><td><p>constant_source_flux_96_85C_1E+11pcm2_z1E-04ps_DSF1E-14_1E+04Vcm_h1E-12_m1E+00_rt12h_rv-1E+04Vcm.ini</p></td>
<td><p>1E+11</p></td>
<td><p>0.0001</p></td>
<td><p>1.00E-14</p></td>
<td><p>10000</p></td>
<td><p>1.00E-12</p></td>
<td><p>1</p></td>
<td><p>345600</p></td>
<td><p>85</p></td>
<td><p>0.075</p></td>
<td><p>43200</p></td>
<td><p>-10000</p></td>
<td><p>-0.075</p></td>
<td><p>0.075</p></td>
<td><p>1</p></td>
<td><p>7</p></td>
<td><p>1.00E-20</p></td>
<td><p>720</p></td>
<td><p>100</p></td>
<td><p>100</p></td>
</tr>
<tr class="row-even"><td><p>constant_source_flux_96_85C_1E+12pcm2_z1E-04ps_DSF1E-14_1E+04Vcm_h1E-12_m1E+00_rt12h_rv-1E+04Vcm.ini</p></td>
<td><p>1E+12</p></td>
<td><p>0.0001</p></td>
<td><p>1.00E-14</p></td>
<td><p>10000</p></td>
<td><p>1.00E-12</p></td>
<td><p>1</p></td>
<td><p>345600</p></td>
<td><p>85</p></td>
<td><p>0.075</p></td>
<td><p>43200</p></td>
<td><p>-10000</p></td>
<td><p>-0.075</p></td>
<td><p>0.075</p></td>
<td><p>1</p></td>
<td><p>7</p></td>
<td><p>1.00E-20</p></td>
<td><p>720</p></td>
<td><p>100</p></td>
<td><p>100</p></td>
</tr>
<tr class="row-odd"><td><p>constant_source_flux_96_85C_1E+13pcm2_z1E-04ps_DSF1E-14_1E+04Vcm_h1E-12_m1E+00_rt12h_rv-1E+04Vcm.ini</p></td>
<td><p>1E+13</p></td>
<td><p>0.0001</p></td>
<td><p>1.00E-14</p></td>
<td><p>10000</p></td>
<td><p>1.00E-12</p></td>
<td><p>1</p></td>
<td><p>345600</p></td>
<td><p>85</p></td>
<td><p>0.075</p></td>
<td><p>43200</p></td>
<td><p>-10000</p></td>
<td><p>-0.075</p></td>
<td><p>0.075</p></td>
<td><p>1</p></td>
<td><p>7</p></td>
<td><p>1.00E-20</p></td>
<td><p>720</p></td>
<td><p>100</p></td>
<td><p>100</p></td>
</tr>
<tr class="row-even"><td><p>constant_source_flux_96_85C_1E+14pcm2_z1E-04ps_DSF1E-14_1E+04Vcm_h1E-12_m1E+00_rt12h_rv-1E+04Vcm.ini</p></td>
<td><p>1E+14</p></td>
<td><p>0.0001</p></td>
<td><p>1.00E-14</p></td>
<td><p>10000</p></td>
<td><p>1.00E-12</p></td>
<td><p>1</p></td>
<td><p>345600</p></td>
<td><p>85</p></td>
<td><p>0.075</p></td>
<td><p>43200</p></td>
<td><p>-10000</p></td>
<td><p>-0.075</p></td>
<td><p>0.075</p></td>
<td><p>1</p></td>
<td><p>7</p></td>
<td><p>1.00E-20</p></td>
<td><p>720</p></td>
<td><p>100</p></td>
<td><p>100</p></td>
</tr>
<tr class="row-odd"><td><p>constant_source_flux_96_85C_1E+10pcm2_z1E-08ps_DSF1E-14_1E+04Vcm_h1E-12_m1E+00_rt12h_rv-1E+04Vcm.ini</p></td>
<td><p>10000000000</p></td>
<td><p>1.00E-08</p></td>
<td><p>1.00E-14</p></td>
<td><p>10000</p></td>
<td><p>1.00E-12</p></td>
<td><p>1</p></td>
<td><p>345600</p></td>
<td><p>85</p></td>
<td><p>0.075</p></td>
<td><p>43200</p></td>
<td><p>-10000</p></td>
<td><p>-0.075</p></td>
<td><p>0.075</p></td>
<td><p>1</p></td>
<td><p>7</p></td>
<td><p>1.00E-20</p></td>
<td><p>720</p></td>
<td><p>100</p></td>
<td><p>100</p></td>
</tr>
<tr class="row-even"><td><p>constant_source_flux_96_85C_1E+10pcm2_z1E-07ps_DSF1E-14_1E+04Vcm_h1E-12_m1E+00_rt12h_rv-1E+04Vcm.ini</p></td>
<td><p>10000000000</p></td>
<td><p>1.00E-07</p></td>
<td><p>1.00E-14</p></td>
<td><p>10000</p></td>
<td><p>1.00E-12</p></td>
<td><p>1</p></td>
<td><p>345600</p></td>
<td><p>85</p></td>
<td><p>0.075</p></td>
<td><p>43200</p></td>
<td><p>-10000</p></td>
<td><p>-0.075</p></td>
<td><p>0.075</p></td>
<td><p>1</p></td>
<td><p>7</p></td>
<td><p>1.00E-20</p></td>
<td><p>720</p></td>
<td><p>100</p></td>
<td><p>100</p></td>
</tr>
<tr class="row-odd"><td><p>constant_source_flux_96_85C_1E+10pcm2_z1E-06ps_DSF1E-14_1E+04Vcm_h1E-12_m1E+00_rt12h_rv-1E+04Vcm.ini</p></td>
<td><p>10000000000</p></td>
<td><p>1.00E-06</p></td>
<td><p>1.00E-14</p></td>
<td><p>10000</p></td>
<td><p>1.00E-12</p></td>
<td><p>1</p></td>
<td><p>345600</p></td>
<td><p>85</p></td>
<td><p>0.075</p></td>
<td><p>43200</p></td>
<td><p>-10000</p></td>
<td><p>-0.075</p></td>
<td><p>0.075</p></td>
<td><p>1</p></td>
<td><p>7</p></td>
<td><p>1.00E-20</p></td>
<td><p>720</p></td>
<td><p>100</p></td>
<td><p>100</p></td>
</tr>
<tr class="row-even"><td><p>constant_source_flux_96_85C_1E+10pcm2_z1E-05ps_DSF1E-14_1E+04Vcm_h1E-12_m1E+00_rt12h_rv-1E+04Vcm.ini</p></td>
<td><p>10000000000</p></td>
<td><p>1.00E-05</p></td>
<td><p>1.00E-14</p></td>
<td><p>10000</p></td>
<td><p>1.00E-12</p></td>
<td><p>1</p></td>
<td><p>345600</p></td>
<td><p>85</p></td>
<td><p>0.075</p></td>
<td><p>43200</p></td>
<td><p>-10000</p></td>
<td><p>-0.075</p></td>
<td><p>0.075</p></td>
<td><p>1</p></td>
<td><p>7</p></td>
<td><p>1.00E-20</p></td>
<td><p>720</p></td>
<td><p>100</p></td>
<td><p>100</p></td>
</tr>
<tr class="row-odd"><td><p>constant_source_flux_96_85C_1E+10pcm2_z1E-04ps_DSF1E-15_1E+04Vcm_h1E-12_m1E+00_rt12h_rv-1E+04Vcm.ini</p></td>
<td><p>10000000000</p></td>
<td><p>0.0001</p></td>
<td><p>1.00E-15</p></td>
<td><p>10000</p></td>
<td><p>1.00E-12</p></td>
<td><p>1</p></td>
<td><p>345600</p></td>
<td><p>85</p></td>
<td><p>0.075</p></td>
<td><p>43200</p></td>
<td><p>-10000</p></td>
<td><p>-0.075</p></td>
<td><p>0.075</p></td>
<td><p>1</p></td>
<td><p>7</p></td>
<td><p>1.00E-20</p></td>
<td><p>720</p></td>
<td><p>100</p></td>
<td><p>100</p></td>
</tr>
<tr class="row-even"><td><p>constant_source_flux_96_85C_1E+10pcm2_z1E-04ps_DSF1E-16_1E+04Vcm_h1E-12_m1E+00_rt12h_rv-1E+04Vcm.ini</p></td>
<td><p>10000000000</p></td>
<td><p>0.0001</p></td>
<td><p>1.00E-16</p></td>
<td><p>10000</p></td>
<td><p>1.00E-12</p></td>
<td><p>1</p></td>
<td><p>345600</p></td>
<td><p>85</p></td>
<td><p>0.075</p></td>
<td><p>43200</p></td>
<td><p>-10000</p></td>
<td><p>-0.075</p></td>
<td><p>0.075</p></td>
<td><p>1</p></td>
<td><p>7</p></td>
<td><p>1.00E-20</p></td>
<td><p>720</p></td>
<td><p>100</p></td>
<td><p>100</p></td>
</tr>
<tr class="row-odd"><td><p>constant_source_flux_96_85C_1E+10pcm2_z1E-04ps_DSF1E-14_1E+01Vcm_h1E-12_m1E+00_rt12h_rv-1E+01Vcm.ini</p></td>
<td><p>10000000000</p></td>
<td><p>0.0001</p></td>
<td><p>1.00E-14</p></td>
<td><p>10</p></td>
<td><p>1.00E-12</p></td>
<td><p>1</p></td>
<td><p>345600</p></td>
<td><p>85</p></td>
<td><p>7.50E-05</p></td>
<td><p>43200</p></td>
<td><p>-10</p></td>
<td><p>-7.50E-05</p></td>
<td><p>0.075</p></td>
<td><p>1</p></td>
<td><p>7</p></td>
<td><p>1.00E-20</p></td>
<td><p>720</p></td>
<td><p>100</p></td>
<td><p>100</p></td>
</tr>
<tr class="row-even"><td><p>constant_source_flux_96_85C_1E+10pcm2_z1E-04ps_DSF1E-14_1E+02Vcm_h1E-12_m1E+00_rt12h_rv-1E+02Vcm.ini</p></td>
<td><p>10000000000</p></td>
<td><p>0.0001</p></td>
<td><p>1.00E-14</p></td>
<td><p>100</p></td>
<td><p>1.00E-12</p></td>
<td><p>1</p></td>
<td><p>345600</p></td>
<td><p>85</p></td>
<td><p>0.00075</p></td>
<td><p>43200</p></td>
<td><p>-100</p></td>
<td><p>-0.00075</p></td>
<td><p>0.075</p></td>
<td><p>1</p></td>
<td><p>7</p></td>
<td><p>1.00E-20</p></td>
<td><p>720</p></td>
<td><p>100</p></td>
<td><p>100</p></td>
</tr>
<tr class="row-odd"><td><p>constant_source_flux_96_85C_1E+10pcm2_z1E-04ps_DSF1E-14_1E+03Vcm_h1E-12_m1E+00_rt12h_rv-1E+03Vcm.ini</p></td>
<td><p>10000000000</p></td>
<td><p>0.0001</p></td>
<td><p>1.00E-14</p></td>
<td><p>1000</p></td>
<td><p>1.00E-12</p></td>
<td><p>1</p></td>
<td><p>345600</p></td>
<td><p>85</p></td>
<td><p>0.0075</p></td>
<td><p>43200</p></td>
<td><p>-1000</p></td>
<td><p>-0.0075</p></td>
<td><p>0.075</p></td>
<td><p>1</p></td>
<td><p>7</p></td>
<td><p>1.00E-20</p></td>
<td><p>720</p></td>
<td><p>100</p></td>
<td><p>100</p></td>
</tr>
<tr class="row-even"><td><p>constant_source_flux_96_85C_1E+10pcm2_z1E-04ps_DSF1E-14_1E+05Vcm_h1E-12_m1E+00_rt12h_rv-1E+05Vcm.ini</p></td>
<td><p>10000000000</p></td>
<td><p>0.0001</p></td>
<td><p>1.00E-14</p></td>
<td><p>100000</p></td>
<td><p>1.00E-12</p></td>
<td><p>1</p></td>
<td><p>345600</p></td>
<td><p>85</p></td>
<td><p>0.75</p></td>
<td><p>43200</p></td>
<td><p>-100000</p></td>
<td><p>-0.75</p></td>
<td><p>0.075</p></td>
<td><p>1</p></td>
<td><p>7</p></td>
<td><p>1.00E-20</p></td>
<td><p>720</p></td>
<td><p>100</p></td>
<td><p>100</p></td>
</tr>
<tr class="row-odd"><td><p>constant_source_flux_96_85C_1E+10pcm2_z1E-04ps_DSF1E-14_1E+06Vcm_h1E-12_m1E+00_rt12h_rv-1E+06Vcm.ini</p></td>
<td><p>10000000000</p></td>
<td><p>0.0001</p></td>
<td><p>1.00E-14</p></td>
<td><p>1000000</p></td>
<td><p>1.00E-12</p></td>
<td><p>1</p></td>
<td><p>345600</p></td>
<td><p>85</p></td>
<td><p>7.5</p></td>
<td><p>43200</p></td>
<td><p>-1000000</p></td>
<td><p>-7.5</p></td>
<td><p>0.075</p></td>
<td><p>1</p></td>
<td><p>7</p></td>
<td><p>1.00E-20</p></td>
<td><p>720</p></td>
<td><p>100</p></td>
<td><p>100</p></td>
</tr>
<tr class="row-even"><td><p>constant_source_flux_96_85C_1E+10pcm2_z1E-04ps_DSF1E-14_1E+04Vcm_h1E-10_m1E+00_rt12h_rv-1E+04Vcm.ini</p></td>
<td><p>10000000000</p></td>
<td><p>0.0001</p></td>
<td><p>1.00E-14</p></td>
<td><p>10000</p></td>
<td><p>1.00E-10</p></td>
<td><p>1</p></td>
<td><p>345600</p></td>
<td><p>85</p></td>
<td><p>0.075</p></td>
<td><p>43200</p></td>
<td><p>-10000</p></td>
<td><p>-0.075</p></td>
<td><p>0.075</p></td>
<td><p>1</p></td>
<td><p>7</p></td>
<td><p>1.00E-20</p></td>
<td><p>720</p></td>
<td><p>100</p></td>
<td><p>100</p></td>
</tr>
<tr class="row-odd"><td><p>constant_source_flux_96_85C_1E+10pcm2_z1E-04ps_DSF1E-14_1E+04Vcm_h1E-08_m1E+00_rt12h_rv-1E+04Vcm.ini</p></td>
<td><p>10000000000</p></td>
<td><p>0.0001</p></td>
<td><p>1.00E-14</p></td>
<td><p>10000</p></td>
<td><p>1.00E-08</p></td>
<td><p>1</p></td>
<td><p>345600</p></td>
<td><p>85</p></td>
<td><p>0.075</p></td>
<td><p>43200</p></td>
<td><p>-10000</p></td>
<td><p>-0.075</p></td>
<td><p>0.075</p></td>
<td><p>1</p></td>
<td><p>7</p></td>
<td><p>1.00E-20</p></td>
<td><p>720</p></td>
<td><p>100</p></td>
<td><p>100</p></td>
</tr>
</tbody>
</table>
<p>Depending on the choice of parameters, large concentration and potential gradients can lead to non-convergent
simulations. The batch script will run the remainder of the simulations that do converge. Adjustments to the time step
and mesh elements might be needed to reach convergence. In any case, it is convenient to add an additional column to
<cite>ofat_db.csv</cite> to flag if the simulation converged for further batch analysis.</p>
</div>
<div class="section" id="one-factor-at-a-time-analysis">
<h1>One-factor-at-a-time analysis<a class="headerlink" href="#one-factor-at-a-time-analysis" title="Permalink to this headline">¶</a></h1>
<p>A script is provided to analyze the output of one-factor-at-a-time batch simulations, which plots the concentration
profile as a function of time for each simulation and also simulates the <span class="math notranslate nohighlight">\(P_{\mathrm{mpp}}\)</span> and
<span class="math notranslate nohighlight">\(R_{\mathrm{sh}}\)</span> as a function of time using a Random Forrest Regression model fit from previous Sentaurus
simulations.</p>
<div class="literal-block-wrapper docutils container" id="id3">
<div class="code-block-caption"><span class="caption-text">one_factor_at_a_time_analysys.py</span><a class="headerlink" href="#id3" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>  1
  2
  3
  4
  5
  6
  7
  8
  9
 10
 11
 12
 13
 14
 15
 16
 17
 18
 19
 20
 21
 22
 23
 24
 25
 26
 27
 28
 29
 30
 31
 32
 33
 34
 35
 36
 37
 38
 39
 40
 41
 42
 43
 44
 45
 46
 47
 48
 49
 50
 51
 52
 53
 54
 55
 56
 57
 58
 59
 60
 61
 62
 63
 64
 65
 66
 67
 68
 69
 70
 71
 72
 73
 74
 75
 76
 77
 78
 79
 80
 81
 82
 83
 84
 85
 86
 87
 88
 89
 90
 91
 92
 93
 94
 95
 96
 97
 98
 99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
238
239
240
241
242
243
244
245
246
247
248
249
250
251
252
253
254
255
256
257
258
259
260
261
262
263
264
265
266
267
268
269
270
271
272
273
274
275
276
277
278
279
280
281
282
283
284
285
286
287
288
289
290
291
292
293
294
295
296
297
298
299
300
301
302
303
304
305
306
307
308
309
310
311
312
313
314
315
316
317
318
319
320
321
322
323
324
325
326
327
328
329
330
331
332
333
334
335
336
337
338
339
340
341
342
343
344
345
346
347
348
349
350
351
352
353
354
355
356
357
358
359
360
361
362
363
364
365
366
367
368
369
370
371
372
373
374
375
376
377
378
379
380
381
382
383
384
385
386
387
388
389
390
391
392
393
394
395
396
397
398
399
400
401
402
403
404
405
406</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">This code runs basic analysis on simulations that were computed using the &#39;one at a time analysis&#39;.</span>

<span class="sd">You must provide the path to the csv database with the parameters of each simulation.</span>

<span class="sd">Functionality:</span>

<span class="sd">1. Plot the last concentration profile over the layer stack.</span>
<span class="sd">2. Plot the Rsh(t) estimated with the series resistor model.</span>
<span class="sd">3. Estimate the integrated sodium concentration in SiNx and Si at the end of the simulation.</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">mpl_toolkits.axes_grid1</span> <span class="kn">import</span> <span class="n">make_axes_locatable</span>
<span class="c1"># import pidsim.rsh as prsh</span>
<span class="kn">import</span> <span class="nn">pidsim.ml_simulator</span> <span class="k">as</span> <span class="nn">pmpp_rf</span>
<span class="kn">import</span> <span class="nn">h5py</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">platform</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">matplotlib</span> <span class="k">as</span> <span class="nn">mpl</span>
<span class="kn">import</span> <span class="nn">matplotlib.ticker</span> <span class="k">as</span> <span class="nn">mticker</span>
<span class="kn">import</span> <span class="nn">matplotlib.gridspec</span> <span class="k">as</span> <span class="nn">gridspec</span>
<span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">integrate</span>
<span class="kn">import</span> <span class="nn">pnptransport.utils</span> <span class="k">as</span> <span class="nn">utils</span>
<span class="kn">from</span> <span class="nn">tqdm</span> <span class="kn">import</span> <span class="n">tqdm</span>

<span class="n">path_to_csv</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;G:\My Drive\Research\PVRD1\Manuscripts\Device_Simulations_draft\simulations\inputs_20200831\ofat_db.csv&#39;</span>
<span class="n">path_to_results</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;G:\My Drive\Research\PVRD1\Manuscripts\Device_Simulations_draft\simulations\inputs_20200831\results&#39;</span>
<span class="n">t_max_h</span> <span class="o">=</span> <span class="mf">96.</span>  <span class="c1"># h</span>

<span class="n">pid_experiment_csv</span> <span class="o">=</span> <span class="kc">None</span> <span class="c1">#&#39;G:\My Drive\Research\PVRD1\DATA\PID\MC4_Raw_IV_modified.csv&#39;</span>

<span class="n">color_map</span> <span class="o">=</span> <span class="s1">&#39;viridis_r&#39;</span>

<span class="n">defaultPlotStyle</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;font.size&#39;</span><span class="p">:</span> <span class="mi">11</span><span class="p">,</span>
    <span class="s1">&#39;font.family&#39;</span><span class="p">:</span> <span class="s1">&#39;Arial&#39;</span><span class="p">,</span>
    <span class="s1">&#39;font.weight&#39;</span><span class="p">:</span> <span class="s1">&#39;regular&#39;</span><span class="p">,</span>
    <span class="s1">&#39;legend.fontsize&#39;</span><span class="p">:</span> <span class="mi">11</span><span class="p">,</span>
    <span class="s1">&#39;mathtext.fontset&#39;</span><span class="p">:</span> <span class="s1">&#39;stix&#39;</span><span class="p">,</span>
    <span class="s1">&#39;xtick.direction&#39;</span><span class="p">:</span> <span class="s1">&#39;in&#39;</span><span class="p">,</span>
    <span class="s1">&#39;ytick.direction&#39;</span><span class="p">:</span> <span class="s1">&#39;in&#39;</span><span class="p">,</span>
    <span class="s1">&#39;xtick.major.size&#39;</span><span class="p">:</span> <span class="mf">4.5</span><span class="p">,</span>
    <span class="s1">&#39;xtick.major.width&#39;</span><span class="p">:</span> <span class="mf">1.75</span><span class="p">,</span>
    <span class="s1">&#39;ytick.major.size&#39;</span><span class="p">:</span> <span class="mf">4.5</span><span class="p">,</span>
    <span class="s1">&#39;ytick.major.width&#39;</span><span class="p">:</span> <span class="mf">1.75</span><span class="p">,</span>
    <span class="s1">&#39;xtick.minor.size&#39;</span><span class="p">:</span> <span class="mf">2.75</span><span class="p">,</span>
    <span class="s1">&#39;xtick.minor.width&#39;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span>
    <span class="s1">&#39;ytick.minor.size&#39;</span><span class="p">:</span> <span class="mf">2.75</span><span class="p">,</span>
    <span class="s1">&#39;ytick.minor.width&#39;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span>
    <span class="s1">&#39;xtick.top&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
    <span class="s1">&#39;ytick.right&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
    <span class="s1">&#39;lines.linewidth&#39;</span><span class="p">:</span> <span class="mf">2.5</span><span class="p">,</span>
    <span class="s1">&#39;lines.markersize&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
    <span class="s1">&#39;lines.markeredgewidth&#39;</span><span class="p">:</span> <span class="mf">0.85</span><span class="p">,</span>
    <span class="s1">&#39;axes.labelpad&#39;</span><span class="p">:</span> <span class="mf">5.0</span><span class="p">,</span>
    <span class="s1">&#39;axes.labelsize&#39;</span><span class="p">:</span> <span class="mi">12</span><span class="p">,</span>
    <span class="s1">&#39;axes.labelweight&#39;</span><span class="p">:</span> <span class="s1">&#39;regular&#39;</span><span class="p">,</span>
    <span class="s1">&#39;legend.handletextpad&#39;</span><span class="p">:</span> <span class="mf">0.2</span><span class="p">,</span>
    <span class="s1">&#39;legend.borderaxespad&#39;</span><span class="p">:</span> <span class="mf">0.2</span><span class="p">,</span>
    <span class="s1">&#39;axes.linewidth&#39;</span><span class="p">:</span> <span class="mf">1.25</span><span class="p">,</span>
    <span class="s1">&#39;axes.titlesize&#39;</span><span class="p">:</span> <span class="mi">12</span><span class="p">,</span>
    <span class="s1">&#39;axes.titleweight&#39;</span><span class="p">:</span> <span class="s1">&#39;bold&#39;</span><span class="p">,</span>
    <span class="s1">&#39;axes.titlepad&#39;</span><span class="p">:</span> <span class="mi">6</span><span class="p">,</span>
    <span class="s1">&#39;figure.titleweight&#39;</span><span class="p">:</span> <span class="s1">&#39;bold&#39;</span><span class="p">,</span>
    <span class="s1">&#39;figure.dpi&#39;</span><span class="p">:</span> <span class="mi">100</span>
<span class="p">}</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">platform</span><span class="o">.</span><span class="n">system</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;Windows&#39;</span><span class="p">:</span>
        <span class="n">path_to_csv</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;</span><span class="se">\\</span><span class="s1">?</span><span class="se">\\</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="n">path_to_csv</span>
        <span class="n">path_to_results</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;</span><span class="se">\\</span><span class="s1">?</span><span class="se">\\</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="n">path_to_results</span>
        <span class="k">if</span> <span class="n">pid_experiment_csv</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">pid_experiment_csv</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;</span><span class="se">\\</span><span class="s1">?</span><span class="se">\\</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="n">pid_experiment_csv</span>

    <span class="n">t_max</span> <span class="o">=</span> <span class="n">t_max_h</span> <span class="o">*</span> <span class="mf">3600.</span>
    <span class="c1"># Create an analysis folder within the base dir for the database file</span>
    <span class="n">working_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">path_to_csv</span><span class="p">)</span>
    <span class="n">analysis_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">working_path</span><span class="p">,</span> <span class="s1">&#39;batch_analysis&#39;</span><span class="p">)</span>
    <span class="c1"># If the folder does not exists, create it</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">analysis_path</span><span class="p">):</span>
        <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">analysis_path</span><span class="p">)</span>

    <span class="c1"># If an experimental profile is provided load the csv</span>
    <span class="k">if</span> <span class="n">pid_experiment_csv</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">pid_experiment_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">pid_experiment_csv</span><span class="p">)</span>

    <span class="c1"># Read the database of simulations</span>
    <span class="n">simulations_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">filepath_or_buffer</span><span class="o">=</span><span class="n">path_to_csv</span><span class="p">)</span>
    <span class="c1"># pick only the simulations that converged</span>
    <span class="n">simulations_df</span> <span class="o">=</span> <span class="n">simulations_df</span><span class="p">[</span><span class="n">simulations_df</span><span class="p">[</span><span class="s1">&#39;converged&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="c1"># Count the simulations</span>
    <span class="n">n_simulations</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">simulations_df</span><span class="p">)</span>
    <span class="n">integrated_final_concentrations</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">n_simulations</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">dtype</span><span class="p">([</span>
        <span class="p">(</span><span class="s1">&#39;C_SiNx average final (atoms/cm^3)&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;C_Si average final (atoms/cm^3)&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">)</span>
    <span class="p">]))</span>
    <span class="c1"># Load the style</span>
    <span class="n">mpl</span><span class="o">.</span><span class="n">rcParams</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">defaultPlotStyle</span><span class="p">)</span>
    <span class="c1"># Get the color map</span>
    <span class="n">cm</span> <span class="o">=</span> <span class="n">mpl</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="n">color_map</span><span class="p">)</span>
    <span class="c1"># Show at least the first 6 figures</span>
    <span class="n">max_displayed_figures</span> <span class="o">=</span> <span class="mi">6</span>
    <span class="n">fig_counter</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">simulations_df</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
        <span class="n">filetag</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="s1">&#39;config file&#39;</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">simga_s</span> <span class="o">=</span> <span class="n">r</span><span class="p">[</span><span class="s1">&#39;sigma_s (cm^-2)&#39;</span><span class="p">]</span>
        <span class="n">zeta</span> <span class="o">=</span> <span class="n">r</span><span class="p">[</span><span class="s1">&#39;zeta (1/s)&#39;</span><span class="p">]</span>
        <span class="n">dsf</span> <span class="o">=</span> <span class="n">r</span><span class="p">[</span><span class="s1">&#39;D_SF (cm^2/s)&#39;</span><span class="p">]</span>
        <span class="n">e_field</span> <span class="o">=</span> <span class="n">r</span><span class="p">[</span><span class="s1">&#39;E (V/cm)&#39;</span><span class="p">]</span>
        <span class="n">h</span> <span class="o">=</span> <span class="n">r</span><span class="p">[</span><span class="s1">&#39;h (cm/s)&#39;</span><span class="p">]</span>
        <span class="n">m</span> <span class="o">=</span> <span class="n">r</span><span class="p">[</span><span class="s1">&#39;m&#39;</span><span class="p">]</span>
        <span class="n">time_max</span> <span class="o">=</span> <span class="n">r</span><span class="p">[</span><span class="s1">&#39;time (s)&#39;</span><span class="p">]</span>
        <span class="n">temp_c</span> <span class="o">=</span> <span class="n">r</span><span class="p">[</span><span class="s1">&#39;temp (C)&#39;</span><span class="p">]</span>

        <span class="n">source_str1</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;$S_{{\mathrm{{s}}}} = </span><span class="si">{0}</span><span class="s1"> \; (\mathrm{{cm^{{-2}}}})$&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
            <span class="n">utils</span><span class="o">.</span><span class="n">latex_order_of_magnitude</span><span class="p">(</span><span class="n">simga_s</span><span class="p">))</span>
        <span class="n">source_str2</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;$k = </span><span class="si">{0}</span><span class="s1"> \; (\mathrm{{1/s}})$&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">utils</span><span class="o">.</span><span class="n">latex_order_of_magnitude</span><span class="p">(</span><span class="n">zeta</span><span class="p">))</span>
        <span class="n">e_field_str</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;$E = </span><span class="si">{0}</span><span class="s1"> \; (\mathrm{{V/cm}})$&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">utils</span><span class="o">.</span><span class="n">latex_order_of_magnitude</span><span class="p">(</span><span class="n">e_field</span><span class="p">))</span>
        <span class="n">h_str</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;$h = </span><span class="si">{0}</span><span class="s1"> \; (\mathrm{{cm/s}})$&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">utils</span><span class="o">.</span><span class="n">latex_order_of_magnitude</span><span class="p">(</span><span class="n">h</span><span class="p">))</span>
        <span class="n">temp_str</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;$</span><span class="si">{0:.0f}</span><span class="s1"> \; (\mathrm{{°C}})$&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">temp_c</span><span class="p">)</span>
        <span class="n">dsf_str</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;$D_{{\mathrm{{SF}}}} = </span><span class="si">{0}</span><span class="s1"> \; (\mathrm{{cm^2/s}})$&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">utils</span><span class="o">.</span><span class="n">latex_order_of_magnitude</span><span class="p">(</span><span class="n">dsf</span><span class="p">))</span>
        <span class="c1"># Normalize the time scale</span>
        <span class="n">normalize</span> <span class="o">=</span> <span class="n">mpl</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">Normalize</span><span class="p">(</span><span class="n">vmin</span><span class="o">=</span><span class="mf">1E-3</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="p">(</span><span class="n">t_max</span> <span class="o">/</span> <span class="mf">3600.</span><span class="p">))</span>
        <span class="c1"># Get a 20 time points geometrically spaced</span>
        <span class="n">requested_time</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">geometric_series_spaced</span><span class="p">(</span><span class="n">max_val</span><span class="o">=</span><span class="n">t_max</span><span class="p">,</span> <span class="n">min_delta</span><span class="o">=</span><span class="mi">600</span><span class="p">,</span> <span class="n">steps</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
        <span class="c1"># Get the full path to the h5 file</span>
        <span class="n">path_to_h5</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path_to_results</span><span class="p">,</span> <span class="n">filetag</span> <span class="o">+</span> <span class="s1">&#39;.h5&#39;</span><span class="p">)</span>
        <span class="c1"># Create the concentration figure</span>
        <span class="n">fig_c</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
        <span class="n">fig_c</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">(</span><span class="mf">5.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">,</span> <span class="n">forward</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">fig_c</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">hspace</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">wspace</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
        <span class="n">gs_c_0</span> <span class="o">=</span> <span class="n">gridspec</span><span class="o">.</span><span class="n">GridSpec</span><span class="p">(</span><span class="n">ncols</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">nrows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">figure</span><span class="o">=</span><span class="n">fig_c</span><span class="p">)</span>
        <span class="c1"># 1 column for the concentration profile in SiNx</span>
        <span class="c1"># 1 column for the concentration profile in Si</span>
        <span class="c1"># 1 column for the colorbar</span>
        <span class="n">gs_c_00</span> <span class="o">=</span> <span class="n">gridspec</span><span class="o">.</span><span class="n">GridSpecFromSubplotSpec</span><span class="p">(</span>
            <span class="n">nrows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">subplot_spec</span><span class="o">=</span><span class="n">gs_c_0</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">wspace</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">hspace</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">width_ratios</span><span class="o">=</span><span class="p">[</span><span class="mf">2.5</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
        <span class="p">)</span>
        <span class="n">ax_c_0</span> <span class="o">=</span> <span class="n">fig_c</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs_c_00</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
        <span class="n">ax_c_1</span> <span class="o">=</span> <span class="n">fig_c</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs_c_00</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>

        <span class="c1"># Axis labels</span>
        <span class="n">ax_c_0</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;Depth (nm)&#39;</span><span class="p">)</span>
        <span class="n">ax_c_0</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;[Na] ($\mathregular{cm^{-3}}$)&#39;</span><span class="p">)</span>
        <span class="c1"># Title to the sinx axis</span>
        <span class="n">ax_c_0</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$</span><span class="si">{0}</span><span class="s1">\; \mathrm{{V/cm}}, </span><span class="si">{1:.0f}</span><span class="s1">\; \mathrm{{°C}}$&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
            <span class="n">utils</span><span class="o">.</span><span class="n">latex_order_of_magnitude</span><span class="p">(</span><span class="n">e_field</span><span class="p">),</span> <span class="n">temp_c</span>
        <span class="p">))</span>
        <span class="c1"># Set the ticks for the Si concentration profile axis to the right</span>
        <span class="n">ax_c_1</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_ticks_position</span><span class="p">(</span><span class="s1">&#39;right&#39;</span><span class="p">)</span>
        <span class="c1"># Title to the si axis</span>
        <span class="n">ax_c_1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$D_{{\mathrm{{SF}}}} = </span><span class="si">{0}</span><span class="s1">\; \mathrm{{cm^2/s}},\; E=0$&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
            <span class="n">utils</span><span class="o">.</span><span class="n">latex_order_of_magnitude</span><span class="p">(</span><span class="n">dsf</span><span class="p">)</span>
        <span class="p">))</span>
        <span class="n">ax_c_1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;Depth (um)&#39;</span><span class="p">)</span>
        <span class="c1"># Log plot in the y axis</span>
        <span class="n">ax_c_0</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
        <span class="n">ax_c_1</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
        <span class="n">ax_c_0</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">bottom</span><span class="o">=</span><span class="mf">1E10</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="mf">1E20</span><span class="p">)</span>
        <span class="n">ax_c_1</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">bottom</span><span class="o">=</span><span class="mf">1E10</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="mf">1E20</span><span class="p">)</span>
        <span class="c1"># Set the ticks for the SiNx log axis</span>
        <span class="n">ax_c_0</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_major_locator</span><span class="p">(</span><span class="n">mpl</span><span class="o">.</span><span class="n">ticker</span><span class="o">.</span><span class="n">LogLocator</span><span class="p">(</span><span class="n">base</span><span class="o">=</span><span class="mf">10.0</span><span class="p">,</span> <span class="n">numticks</span><span class="o">=</span><span class="mi">6</span><span class="p">))</span>
        <span class="n">ax_c_0</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_minor_locator</span><span class="p">(</span><span class="n">mpl</span><span class="o">.</span><span class="n">ticker</span><span class="o">.</span><span class="n">LogLocator</span><span class="p">(</span><span class="n">base</span><span class="o">=</span><span class="mf">10.0</span><span class="p">,</span> <span class="n">numticks</span><span class="o">=</span><span class="mi">60</span><span class="p">,</span> <span class="n">subs</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span> <span class="o">*</span> <span class="o">.</span><span class="mi">1</span><span class="p">))</span>
        <span class="c1"># Set the ticks for the Si log axis</span>
        <span class="n">ax_c_1</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_major_locator</span><span class="p">(</span><span class="n">mpl</span><span class="o">.</span><span class="n">ticker</span><span class="o">.</span><span class="n">LogLocator</span><span class="p">(</span><span class="n">base</span><span class="o">=</span><span class="mf">10.0</span><span class="p">,</span> <span class="n">numticks</span><span class="o">=</span><span class="mi">6</span><span class="p">))</span>
        <span class="n">ax_c_1</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_minor_locator</span><span class="p">(</span><span class="n">mpl</span><span class="o">.</span><span class="n">ticker</span><span class="o">.</span><span class="n">LogLocator</span><span class="p">(</span><span class="n">base</span><span class="o">=</span><span class="mf">10.0</span><span class="p">,</span> <span class="n">numticks</span><span class="o">=</span><span class="mi">60</span><span class="p">,</span> <span class="n">subs</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span> <span class="o">*</span> <span class="o">.</span><span class="mi">1</span><span class="p">))</span>
        <span class="n">ax_c_1</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">left</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">labelright</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="c1"># Configure the ticks for the x axis</span>
        <span class="n">ax_c_0</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_locator</span><span class="p">(</span><span class="n">mticker</span><span class="o">.</span><span class="n">MaxNLocator</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">prune</span><span class="o">=</span><span class="kc">None</span><span class="p">))</span>
        <span class="n">ax_c_0</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_minor_locator</span><span class="p">(</span><span class="n">mticker</span><span class="o">.</span><span class="n">AutoMinorLocator</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
        <span class="n">ax_c_1</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_locator</span><span class="p">(</span><span class="n">mticker</span><span class="o">.</span><span class="n">MaxNLocator</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">prune</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">))</span>
        <span class="n">ax_c_1</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_minor_locator</span><span class="p">(</span><span class="n">mticker</span><span class="o">.</span><span class="n">AutoMinorLocator</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
        <span class="c1"># Change the background colors</span>
        <span class="c1"># ax_c_0.set_facecolor((0.89, 0.75, 1.0))</span>
        <span class="c1"># ax_c_1.set_facecolor((0.82, 0.83, 1.0))</span>
        <span class="c1"># Create the integrated concentration figure</span>
        <span class="n">fig_s</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
        <span class="n">fig_s</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">(</span><span class="mf">4.75</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">,</span> <span class="n">forward</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">fig_s</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">hspace</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">wspace</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
        <span class="n">gs_s_0</span> <span class="o">=</span> <span class="n">gridspec</span><span class="o">.</span><span class="n">GridSpec</span><span class="p">(</span><span class="n">ncols</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">nrows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">figure</span><span class="o">=</span><span class="n">fig_s</span><span class="p">)</span>
        <span class="n">gs_s_00</span> <span class="o">=</span> <span class="n">gridspec</span><span class="o">.</span><span class="n">GridSpecFromSubplotSpec</span><span class="p">(</span>
            <span class="n">nrows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">subplot_spec</span><span class="o">=</span><span class="n">gs_s_0</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">hspace</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">ax_s_0</span> <span class="o">=</span> <span class="n">fig_s</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs_s_00</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
        <span class="c1"># Set the axis labels</span>
        <span class="n">ax_s_0</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;Time (h)&#39;</span><span class="p">)</span>
        <span class="n">ax_s_0</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\bar</span><span class="si">{C}</span><span class="s1">$ ($\mathregular{cm^{-3}}$)&#39;</span><span class="p">)</span>
        <span class="c1"># Set the limits for the x axis</span>
        <span class="n">ax_s_0</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="n">t_max</span> <span class="o">/</span> <span class="mf">3600.</span><span class="p">)</span>
        <span class="c1"># Make the y axis log</span>
        <span class="n">ax_s_0</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
        <span class="c1"># Set the ticks for the y axis</span>
        <span class="n">ax_s_0</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_major_locator</span><span class="p">(</span><span class="n">mpl</span><span class="o">.</span><span class="n">ticker</span><span class="o">.</span><span class="n">LogLocator</span><span class="p">(</span><span class="n">base</span><span class="o">=</span><span class="mf">10.0</span><span class="p">,</span> <span class="n">numticks</span><span class="o">=</span><span class="mi">6</span><span class="p">))</span>
        <span class="n">ax_s_0</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_minor_locator</span><span class="p">(</span><span class="n">mpl</span><span class="o">.</span><span class="n">ticker</span><span class="o">.</span><span class="n">LogLocator</span><span class="p">(</span><span class="n">base</span><span class="o">=</span><span class="mf">10.0</span><span class="p">,</span> <span class="n">numticks</span><span class="o">=</span><span class="mi">60</span><span class="p">,</span> <span class="n">subs</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span> <span class="o">*</span> <span class="o">.</span><span class="mi">1</span><span class="p">))</span>
        <span class="c1"># Set the ticks for the x axis</span>
        <span class="c1"># Configure the ticks for the x axis</span>
        <span class="n">ax_s_0</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_locator</span><span class="p">(</span><span class="n">mticker</span><span class="o">.</span><span class="n">MaxNLocator</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="n">prune</span><span class="o">=</span><span class="kc">None</span><span class="p">))</span>
        <span class="n">ax_s_0</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_minor_locator</span><span class="p">(</span><span class="n">mticker</span><span class="o">.</span><span class="n">AutoMinorLocator</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
        <span class="c1"># Create the rsh figure</span>
        <span class="n">fig_r</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
        <span class="n">fig_r</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">(</span><span class="mf">4.75</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">,</span> <span class="n">forward</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">fig_r</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">hspace</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">wspace</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
        <span class="n">gs_r_0</span> <span class="o">=</span> <span class="n">gridspec</span><span class="o">.</span><span class="n">GridSpec</span><span class="p">(</span><span class="n">ncols</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">nrows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">figure</span><span class="o">=</span><span class="n">fig_r</span><span class="p">)</span>
        <span class="n">gs_r_00</span> <span class="o">=</span> <span class="n">gridspec</span><span class="o">.</span><span class="n">GridSpecFromSubplotSpec</span><span class="p">(</span>
            <span class="n">nrows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">subplot_spec</span><span class="o">=</span><span class="n">gs_r_0</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">hspace</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">ax_r_0</span> <span class="o">=</span> <span class="n">fig_r</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs_r_00</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
        <span class="c1"># Set the axis labels</span>
        <span class="n">ax_r_0</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;Time (h)&#39;</span><span class="p">)</span>
        <span class="n">ax_r_0</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$R_{\mathrm</span><span class="si">{sh}</span><span class="s1">}$ ($\mathrm{\Omega\cdot cm^2}}$)&#39;</span><span class="p">)</span>

        <span class="k">with</span> <span class="n">h5py</span><span class="o">.</span><span class="n">File</span><span class="p">(</span><span class="n">path_to_h5</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">hf</span><span class="p">:</span>
            <span class="c1"># Get the time dataset</span>
            <span class="n">time_s</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">hf</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">])</span>
            <span class="c1"># Get the sinx group</span>
            <span class="n">grp_sinx</span> <span class="o">=</span> <span class="n">hf</span><span class="p">[</span><span class="s1">&#39;L1&#39;</span><span class="p">]</span>
            <span class="c1"># get the si group</span>
            <span class="n">grp_si</span> <span class="o">=</span> <span class="n">hf</span><span class="p">[</span><span class="s1">&#39;L2&#39;</span><span class="p">]</span>
            <span class="c1"># Get the position vector in SiNx in nm</span>
            <span class="n">x_sin</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">grp_sinx</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">])</span> <span class="o">*</span> <span class="mf">1000.</span>
            <span class="n">thickness_sin</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">x_sin</span><span class="p">)</span>
            <span class="n">x_si</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">grp_si</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">])</span> <span class="o">-</span> <span class="n">thickness_sin</span> <span class="o">/</span> <span class="mf">1000.</span>
            <span class="n">x_sin</span> <span class="o">=</span> <span class="n">x_sin</span> <span class="o">-</span> <span class="n">thickness_sin</span>
            <span class="n">thickness_si</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">amax</span><span class="p">(</span><span class="n">x_si</span><span class="p">)</span>
            <span class="n">n_profiles</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">time_s</span><span class="p">)</span>
            <span class="n">requested_indices</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">get_indices_at_values</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">time_s</span><span class="p">,</span> <span class="n">requested_values</span><span class="o">=</span><span class="n">requested_time</span><span class="p">)</span>
            <span class="n">time_profile</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">requested_indices</span><span class="p">))</span>

            <span class="n">model_colors</span> <span class="o">=</span> <span class="p">[</span><span class="n">cm</span><span class="p">(</span><span class="n">normalize</span><span class="p">(</span><span class="n">t</span><span class="p">))</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">time_s</span> <span class="o">/</span> <span class="mf">3600.</span><span class="p">]</span>
            <span class="n">scalar_maps</span> <span class="o">=</span> <span class="n">mpl</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">ScalarMappable</span><span class="p">(</span><span class="n">cmap</span><span class="o">=</span><span class="n">cm</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">normalize</span><span class="p">)</span>
            <span class="k">with</span> <span class="n">tqdm</span><span class="p">(</span><span class="n">requested_indices</span><span class="p">,</span> <span class="n">leave</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">position</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="k">as</span> <span class="n">pbar</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">requested_indices</span><span class="p">):</span>
                    <span class="n">time_j</span> <span class="o">=</span> <span class="n">time_s</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">/</span> <span class="mf">3600.</span>
                    <span class="n">time_profile</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">time_j</span>
                    <span class="c1"># Get the specific profile</span>
                    <span class="n">ct_ds</span> <span class="o">=</span> <span class="s1">&#39;ct_</span><span class="si">{0:d}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">idx</span><span class="p">)</span>
                    <span class="n">c_sin</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">grp_sinx</span><span class="p">[</span><span class="s1">&#39;concentration&#39;</span><span class="p">][</span><span class="n">ct_ds</span><span class="p">])</span>
                    <span class="n">c_si</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">grp_si</span><span class="p">[</span><span class="s1">&#39;concentration&#39;</span><span class="p">][</span><span class="n">ct_ds</span><span class="p">])</span>
                    <span class="n">color_j</span> <span class="o">=</span> <span class="n">cm</span><span class="p">(</span><span class="n">normalize</span><span class="p">(</span><span class="n">time_j</span><span class="p">))</span>
                    <span class="n">ax_c_0</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_sin</span><span class="p">,</span> <span class="n">c_sin</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color_j</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
                    <span class="n">ax_c_1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_si</span><span class="p">,</span> <span class="n">c_si</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color_j</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
                    <span class="n">pbar</span><span class="o">.</span><span class="n">set_description</span><span class="p">(</span><span class="s1">&#39;Extracting profile </span><span class="si">{0}</span><span class="s1"> at time </span><span class="si">{1:.1f}</span><span class="s1"> h...&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ct_ds</span><span class="p">,</span> <span class="n">time_j</span><span class="p">))</span>
                    <span class="n">pbar</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
                    <span class="n">pbar</span><span class="o">.</span><span class="n">refresh</span><span class="p">()</span>

            <span class="c1"># Estimate the integrated concentrations as a function of time for each layer</span>
            <span class="n">c_sin_int</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">n_profiles</span><span class="p">)</span>
            <span class="n">c_si_int</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">n_profiles</span><span class="p">)</span>
            <span class="k">with</span> <span class="n">tqdm</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">n_profiles</span><span class="p">),</span> <span class="n">leave</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">position</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="k">as</span> <span class="n">pbar</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_profiles</span><span class="p">):</span>
                    <span class="c1"># Get the specific profile</span>
                    <span class="n">ct_ds</span> <span class="o">=</span> <span class="s1">&#39;ct_</span><span class="si">{0:d}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">j</span><span class="p">)</span>
                    <span class="n">c_sin</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">grp_sinx</span><span class="p">[</span><span class="s1">&#39;concentration&#39;</span><span class="p">][</span><span class="n">ct_ds</span><span class="p">])</span>
                    <span class="n">c_si</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">grp_si</span><span class="p">[</span><span class="s1">&#39;concentration&#39;</span><span class="p">][</span><span class="n">ct_ds</span><span class="p">])</span>
                    <span class="n">c_sin_int</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">integrate</span><span class="o">.</span><span class="n">simps</span><span class="p">(</span><span class="n">c_sin</span><span class="p">,</span> <span class="o">-</span><span class="n">x_sin</span> <span class="p">))</span> <span class="o">/</span> <span class="n">thickness_sin</span>
                    <span class="n">c_si_int</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">integrate</span><span class="o">.</span><span class="n">simps</span><span class="p">(</span><span class="n">c_si</span><span class="p">,</span> <span class="n">x_si</span><span class="p">))</span> <span class="o">/</span> <span class="n">thickness_si</span>
                    <span class="n">pbar</span><span class="o">.</span><span class="n">set_description</span><span class="p">(</span><span class="s1">&#39;Integrating profile at time </span><span class="si">{0:.1f}</span><span class="s1"> h: S_N: </span><span class="si">{1:.2E}</span><span class="s1">, S_S: </span><span class="si">{2:.3E}</span><span class="s1"> cm^-2&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                        <span class="n">time_s</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">/</span> <span class="mf">3600.</span><span class="p">,</span>
                        <span class="n">c_sin_int</span><span class="p">[</span><span class="n">j</span><span class="p">],</span>
                        <span class="n">c_si_int</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
                    <span class="p">))</span>
                    <span class="n">pbar</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
                    <span class="n">pbar</span><span class="o">.</span><span class="n">refresh</span><span class="p">()</span>

        <span class="n">ax_s_0</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">time_s</span> <span class="o">/</span> <span class="mf">3600.</span><span class="p">,</span> <span class="n">c_sin_int</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$\mathregular</span><span class="si">{SiN_x}</span><span class="s1">$&#39;</span><span class="p">)</span>
        <span class="n">ax_s_0</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">time_s</span> <span class="o">/</span> <span class="mf">3600.</span><span class="p">,</span> <span class="n">c_si_int</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;Si&#39;</span><span class="p">)</span>
        <span class="c1"># ax_s_0.plot(time_s / 3600., c_si_int + c_sin_int, label=r&#39;Si + $\mathregular{SiN_x}$&#39;)</span>

        <span class="n">integrated_final_concentrations</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">c_sin_int</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">c_si_int</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>

        <span class="n">leg</span> <span class="o">=</span> <span class="n">ax_s_0</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;lower right&#39;</span><span class="p">,</span> <span class="n">frameon</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="c1"># Set the limits for the x axis of the concentration plot</span>
        <span class="n">ax_c_0</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">amin</span><span class="p">(</span><span class="n">x_sin</span><span class="p">),</span> <span class="n">right</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">amax</span><span class="p">(</span><span class="n">x_sin</span><span class="p">))</span>
        <span class="n">ax_c_1</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">amin</span><span class="p">(</span><span class="n">x_si</span><span class="p">),</span> <span class="n">right</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">amax</span><span class="p">(</span><span class="n">x_si</span><span class="p">))</span>
        <span class="c1"># Add the color bar</span>
        <span class="n">divider</span> <span class="o">=</span> <span class="n">make_axes_locatable</span><span class="p">(</span><span class="n">ax_c_1</span><span class="p">)</span>
        <span class="n">cax</span> <span class="o">=</span> <span class="n">divider</span><span class="o">.</span><span class="n">append_axes</span><span class="p">(</span><span class="s2">&quot;right&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="s2">&quot;7.5%&quot;</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">0.03</span><span class="p">)</span>
        <span class="n">cbar</span> <span class="o">=</span> <span class="n">fig_c</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">scalar_maps</span><span class="p">,</span> <span class="n">cax</span><span class="o">=</span><span class="n">cax</span><span class="p">)</span>
        <span class="n">cbar</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s1">&#39;Time (h)</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">90</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
        <span class="n">cbar</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">labelsize</span><span class="o">=</span><span class="mi">11</span><span class="p">)</span>

        <span class="n">plot_c_sin_txt</span> <span class="o">=</span> <span class="n">source_str1</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="n">source_str2</span>
        <span class="n">ax_c_0</span><span class="o">.</span><span class="n">text</span><span class="p">(</span>
            <span class="mf">0.95</span><span class="p">,</span> <span class="mf">0.95</span><span class="p">,</span>
            <span class="n">plot_c_sin_txt</span><span class="p">,</span>
            <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">,</span>
            <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;top&#39;</span><span class="p">,</span>
            <span class="n">transform</span><span class="o">=</span><span class="n">ax_c_0</span><span class="o">.</span><span class="n">transAxes</span><span class="p">,</span>
            <span class="n">fontsize</span><span class="o">=</span><span class="mi">11</span><span class="p">,</span>
            <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span>
        <span class="p">)</span>

        <span class="n">plot_c_si_txt</span> <span class="o">=</span> <span class="n">h_str</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">$m=1$&#39;</span>
        <span class="n">ax_c_1</span><span class="o">.</span><span class="n">text</span><span class="p">(</span>
            <span class="mf">0.95</span><span class="p">,</span> <span class="mf">0.95</span><span class="p">,</span>
            <span class="n">plot_c_si_txt</span><span class="p">,</span>
            <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">,</span>
            <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;top&#39;</span><span class="p">,</span>
            <span class="n">transform</span><span class="o">=</span><span class="n">ax_c_1</span><span class="o">.</span><span class="n">transAxes</span><span class="p">,</span>
            <span class="n">fontsize</span><span class="o">=</span><span class="mi">11</span><span class="p">,</span>
            <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span>
        <span class="p">)</span>

        <span class="c1"># Identify layers</span>
        <span class="n">ax_c_0</span><span class="o">.</span><span class="n">text</span><span class="p">(</span>
            <span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.015</span><span class="p">,</span>
            <span class="sa">r</span><span class="s1">&#39;$\mathregular</span><span class="si">{SiN_x}</span><span class="s1">$&#39;</span><span class="p">,</span>
            <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span>
            <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;bottom&#39;</span><span class="p">,</span>
            <span class="n">transform</span><span class="o">=</span><span class="n">ax_c_0</span><span class="o">.</span><span class="n">transAxes</span><span class="p">,</span>
            <span class="n">fontsize</span><span class="o">=</span><span class="mi">11</span><span class="p">,</span>
            <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">,</span>
            <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span>
        <span class="p">)</span>

        <span class="n">ax_c_1</span><span class="o">.</span><span class="n">text</span><span class="p">(</span>
            <span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.015</span><span class="p">,</span>
            <span class="s1">&#39;Si&#39;</span><span class="p">,</span>
            <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span>
            <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;bottom&#39;</span><span class="p">,</span>
            <span class="n">transform</span><span class="o">=</span><span class="n">ax_c_1</span><span class="o">.</span><span class="n">transAxes</span><span class="p">,</span>
            <span class="n">fontsize</span><span class="o">=</span><span class="mi">11</span><span class="p">,</span>
            <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">,</span>
            <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span>
        <span class="p">)</span>

        <span class="c1"># set the y axis limits for the integrated concentration plot</span>
        <span class="n">ax_s_0</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">bottom</span><span class="o">=</span><span class="mf">1E5</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="mf">1E20</span><span class="p">)</span>
        <span class="n">title_str</span> <span class="o">=</span> <span class="n">source_str1</span> <span class="o">+</span> <span class="s1">&#39;, &#39;</span> <span class="o">+</span> <span class="n">source_str2</span> <span class="o">+</span> <span class="s1">&#39;, &#39;</span> <span class="o">+</span> <span class="n">dsf_str</span>

        <span class="n">plot_txt</span> <span class="o">=</span> <span class="n">e_field_str</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="n">temp_str</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="n">h_str</span>
        <span class="n">ax_s_0</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">title_str</span><span class="p">)</span>
        <span class="n">ax_s_0</span><span class="o">.</span><span class="n">text</span><span class="p">(</span>
            <span class="mf">0.65</span><span class="p">,</span> <span class="mf">0.95</span><span class="p">,</span>
            <span class="n">plot_txt</span><span class="p">,</span>
            <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span>
            <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;top&#39;</span><span class="p">,</span>
            <span class="n">transform</span><span class="o">=</span><span class="n">ax_s_0</span><span class="o">.</span><span class="n">transAxes</span><span class="p">,</span>
            <span class="n">fontsize</span><span class="o">=</span><span class="mi">11</span><span class="p">,</span>
            <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span>
        <span class="p">)</span>

        <span class="c1"># rsh_analysis = prsh.Rsh(h5_transport_file=path_to_h5)</span>
        <span class="n">ml_analysis</span> <span class="o">=</span> <span class="n">pmpp_rf</span><span class="o">.</span><span class="n">MLSim</span><span class="p">(</span><span class="n">h5_transport_file</span><span class="o">=</span><span class="n">path_to_h5</span><span class="p">)</span>
        <span class="n">time_s</span> <span class="o">=</span> <span class="n">ml_analysis</span><span class="o">.</span><span class="n">time_s</span>
        <span class="n">time_h</span> <span class="o">=</span> <span class="n">time_s</span> <span class="o">/</span> <span class="mf">3600.</span>
        <span class="n">requested_indices</span> <span class="o">=</span> <span class="n">ml_analysis</span><span class="o">.</span><span class="n">get_requested_time_indices</span><span class="p">(</span><span class="n">time_s</span><span class="p">)</span>
        <span class="n">pmpp</span> <span class="o">=</span> <span class="n">ml_analysis</span><span class="o">.</span><span class="n">pmpp_time_series</span><span class="p">(</span><span class="n">requested_indices</span><span class="o">=</span><span class="n">requested_indices</span><span class="p">)</span>
        <span class="n">rsh</span> <span class="o">=</span> <span class="n">ml_analysis</span><span class="o">.</span><span class="n">rsh_time_series</span><span class="p">(</span><span class="n">requested_indices</span><span class="o">=</span><span class="n">requested_indices</span><span class="p">)</span>

        <span class="n">simulated_pmpp_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;time (s)&#39;</span><span class="p">:</span> <span class="n">time_s</span><span class="p">,</span> <span class="s1">&#39;Pmpp (mW/cm^2)&#39;</span><span class="p">:</span> <span class="n">pmpp</span><span class="p">,</span> <span class="s1">&#39;Rsh (Ohm cm^2)&#39;</span> <span class="p">:</span> <span class="n">rsh</span><span class="p">})</span>
        <span class="n">simulated_pmpp_df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">analysis_path</span><span class="p">,</span> <span class="n">filetag</span> <span class="o">+</span> <span class="s1">&#39;_simulated_pid.csv&#39;</span><span class="p">),</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

        <span class="n">ax_r_0</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">time_h</span><span class="p">,</span> <span class="n">pmpp</span> <span class="o">/</span> <span class="n">pmpp</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Simulation&#39;</span><span class="p">)</span>
        <span class="n">ax_r_0</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">amax</span><span class="p">(</span><span class="n">time_h</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">pid_experiment_csv</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">time_exp</span> <span class="o">=</span> <span class="n">pid_experiment_df</span><span class="p">[</span><span class="s1">&#39;time (s)&#39;</span><span class="p">]</span><span class="o">/</span><span class="mf">3600.</span>
            <span class="n">pmax_exp</span> <span class="o">=</span> <span class="n">pid_experiment_df</span><span class="p">[</span><span class="s1">&#39;Pmax&#39;</span><span class="p">]</span>
            <span class="n">ax_r_0</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">time_exp</span><span class="p">,</span> <span class="n">pmax_exp</span> <span class="o">/</span> <span class="n">pmax_exp</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;None&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">fillstyle</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Experiment&#39;</span><span class="p">)</span>
            <span class="n">leg</span> <span class="o">=</span> <span class="n">ax_r_0</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;lower right&#39;</span><span class="p">,</span> <span class="n">frameon</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="c1"># ax_r_0.set_yscale(&#39;log&#39;)</span>
        <span class="n">ax_r_0</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;time (h)&#39;</span><span class="p">)</span>
        <span class="c1"># ax_r_0.set_ylabel(&#39;$R_{\mathrm{sh}}\;(\Omega \cdot \mathregular{cm^2})$&#39;)</span>
        <span class="n">ax_r_0</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Normalized Power&#39;</span><span class="p">)</span>

        <span class="n">ax_r_0</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_locator</span><span class="p">(</span><span class="n">mticker</span><span class="o">.</span><span class="n">MaxNLocator</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="n">prune</span><span class="o">=</span><span class="kc">None</span><span class="p">))</span>
        <span class="n">ax_r_0</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_minor_locator</span><span class="p">(</span><span class="n">mticker</span><span class="o">.</span><span class="n">AutoMinorLocator</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>

        <span class="n">title_str</span> <span class="o">=</span> <span class="n">source_str1</span> <span class="o">+</span> <span class="s1">&#39;, &#39;</span> <span class="o">+</span> <span class="n">source_str2</span> <span class="o">+</span> <span class="s1">&#39;, &#39;</span> <span class="o">+</span> <span class="n">dsf_str</span>

        <span class="n">plot_txt</span> <span class="o">=</span> <span class="n">e_field_str</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="n">temp_str</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="n">h_str</span>
        <span class="n">ax_r_0</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">title_str</span><span class="p">)</span>
        <span class="n">ax_r_0</span><span class="o">.</span><span class="n">text</span><span class="p">(</span>
            <span class="mf">0.65</span><span class="p">,</span> <span class="mf">0.95</span><span class="p">,</span>
            <span class="n">plot_txt</span><span class="p">,</span>
            <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span>
            <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;top&#39;</span><span class="p">,</span>
            <span class="n">transform</span><span class="o">=</span><span class="n">ax_r_0</span><span class="o">.</span><span class="n">transAxes</span><span class="p">,</span>
            <span class="n">fontsize</span><span class="o">=</span><span class="mi">11</span><span class="p">,</span>
            <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span>
        <span class="p">)</span>

        <span class="n">fig_c</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
        <span class="n">fig_s</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
        <span class="n">fig_r</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>

        <span class="n">fig_c</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">analysis_path</span><span class="p">,</span> <span class="n">filetag</span> <span class="o">+</span> <span class="s1">&#39;_c.png&#39;</span><span class="p">),</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">600</span><span class="p">)</span>
        <span class="n">fig_c</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">analysis_path</span><span class="p">,</span> <span class="n">filetag</span> <span class="o">+</span> <span class="s1">&#39;_c.svg&#39;</span><span class="p">),</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">600</span><span class="p">)</span>
        <span class="n">fig_s</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">analysis_path</span><span class="p">,</span> <span class="n">filetag</span> <span class="o">+</span> <span class="s1">&#39;_s.png&#39;</span><span class="p">),</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">600</span><span class="p">)</span>
        <span class="n">fig_r</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">analysis_path</span><span class="p">,</span> <span class="n">filetag</span> <span class="o">+</span> <span class="s1">&#39;_p.png&#39;</span><span class="p">),</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">600</span><span class="p">)</span>
        <span class="n">fig_r</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">analysis_path</span><span class="p">,</span> <span class="n">filetag</span> <span class="o">+</span> <span class="s1">&#39;_p.svg&#39;</span><span class="p">),</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">600</span><span class="p">)</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="n">fig_c</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="n">fig_s</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="n">fig_r</span><span class="p">)</span>

        <span class="k">del</span> <span class="n">fig_c</span><span class="p">,</span> <span class="n">fig_s</span><span class="p">,</span> <span class="n">fig_r</span>

    <span class="n">simulations_df</span><span class="p">[</span><span class="s1">&#39;C_SiNx average final (atoms/cm^3)&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">integrated_final_concentrations</span><span class="p">[</span><span class="s1">&#39;C_SiNx average final (atoms/cm^3)&#39;</span><span class="p">]</span>
    <span class="n">simulations_df</span><span class="p">[</span><span class="s1">&#39;C_Si average final (atoms/cm^3)&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">integrated_final_concentrations</span><span class="p">[</span><span class="s1">&#39;C_Si average final (atoms/cm^3)&#39;</span><span class="p">]</span>

    <span class="n">simulations_df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">analysis_path</span><span class="p">,</span> <span class="s1">&#39;ofat_analysis.csv&#39;</span><span class="p">),</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>


</pre></div>
</td></tr></table></div>
</div>
<p>Change the path to the csv file using the variable <cite>path_to_csv</cite> on line 28 to point to the csv <cite>ofat_db.csv</cite> from the
previous simulation. Also update the path to which the results are expected to be stored by changing the variable
<cite>path_to_results</cite> on line 29.</p>
<p><cite>t_max_h</cite> in line 30 represents the maximum time to be plotted.</p>
<p>For each simulation the following plots are generated</p>
<ol class="arabic simple">
<li><p>A plot of the Na concentration profile as a function of time indicated in color scale. Saved in png and svg (vector)
formats.</p></li>
<li><p>A plot of <span class="math notranslate nohighlight">\(P_{\mathrm{mpp}}\)</span> as a function of time. Saved in png and svg (vector) formats. Additionally a
csv file is generated with the data from the plot.</p></li>
<li><p>A plot showing the average concentration in each layer, as a function of time. Save in png format.</p></li>
</ol>
<p>The output is saved
within the <cite>path_to_output</cite> using the following structure</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">output_folder</span>
<span class="o">|---</span><span class="n">batch_analysis</span>
<span class="o">|</span>   <span class="o">|---</span><span class="n">constant_source_flux_96_85C_1E</span><span class="o">+</span><span class="mi">10</span><span class="n">pcm2_z1E</span><span class="o">-</span><span class="mi">04</span><span class="n">ps_DSF1E</span><span class="o">-</span><span class="mf">14_1E+01</span><span class="n">Vcm_h1E</span><span class="o">-</span><span class="mi">12</span><span class="n">_m1E</span><span class="o">+</span><span class="mi">00</span><span class="n">_rt12h_rv</span><span class="o">-</span><span class="mf">1E+01</span><span class="n">Vcm_c</span><span class="o">.</span><span class="n">png</span>
<span class="o">|</span>   <span class="o">|---</span><span class="n">constant_source_flux_96_85C_1E</span><span class="o">+</span><span class="mi">10</span><span class="n">pcm2_z1E</span><span class="o">-</span><span class="mi">04</span><span class="n">ps_DSF1E</span><span class="o">-</span><span class="mf">14_1E+01</span><span class="n">Vcm_h1E</span><span class="o">-</span><span class="mi">12</span><span class="n">_m1E</span><span class="o">+</span><span class="mi">00</span><span class="n">_rt12h_rv</span><span class="o">-</span><span class="mf">1E+01</span><span class="n">Vcm_c</span><span class="o">.</span><span class="n">svg</span>
<span class="o">|</span>   <span class="o">|---</span><span class="n">constant_source_flux_96_85C_1E</span><span class="o">+</span><span class="mi">10</span><span class="n">pcm2_z1E</span><span class="o">-</span><span class="mi">04</span><span class="n">ps_DSF1E</span><span class="o">-</span><span class="mf">14_1E+01</span><span class="n">Vcm_h1E</span><span class="o">-</span><span class="mi">12</span><span class="n">_m1E</span><span class="o">+</span><span class="mi">00</span><span class="n">_rt12h_rv</span><span class="o">-</span><span class="mf">1E+01</span><span class="n">Vcm_p</span><span class="o">.</span><span class="n">png</span>
<span class="o">|</span>   <span class="o">|---</span><span class="n">constant_source_flux_96_85C_1E</span><span class="o">+</span><span class="mi">10</span><span class="n">pcm2_z1E</span><span class="o">-</span><span class="mi">04</span><span class="n">ps_DSF1E</span><span class="o">-</span><span class="mf">14_1E+01</span><span class="n">Vcm_h1E</span><span class="o">-</span><span class="mi">12</span><span class="n">_m1E</span><span class="o">+</span><span class="mi">00</span><span class="n">_rt12h_rv</span><span class="o">-</span><span class="mf">1E+01</span><span class="n">Vcm_p</span><span class="o">.</span><span class="n">svg</span>
<span class="o">|</span>   <span class="o">|---</span><span class="n">constant_source_flux_96_85C_1E</span><span class="o">+</span><span class="mi">10</span><span class="n">pcm2_z1E</span><span class="o">-</span><span class="mi">04</span><span class="n">ps_DSF1E</span><span class="o">-</span><span class="mf">14_1E+01</span><span class="n">Vcm_h1E</span><span class="o">-</span><span class="mi">12</span><span class="n">_m1E</span><span class="o">+</span><span class="mi">00</span><span class="n">_rt12h_rv</span><span class="o">-</span><span class="mf">1E+01</span><span class="n">Vcm_s</span><span class="o">.</span><span class="n">svg</span>
<span class="o">|</span>   <span class="o">|---</span><span class="n">constant_source_flux_96_85C_1E</span><span class="o">+</span><span class="mi">10</span><span class="n">pcm2_z1E</span><span class="o">-</span><span class="mi">04</span><span class="n">ps_DSF1E</span><span class="o">-</span><span class="mf">14_1E+01</span><span class="n">Vcm_h1E</span><span class="o">-</span><span class="mi">12</span><span class="n">_m1E</span><span class="o">+</span><span class="mi">00</span><span class="n">_rt12h_rv</span><span class="o">-</span><span class="mf">1E+01</span><span class="n">Vcm_simulated_pid</span><span class="o">.</span><span class="n">csv</span>
<span class="o">|</span>   <span class="o">|---</span><span class="n">constant_source_flux_96_85C_1E</span><span class="o">+</span><span class="mi">10</span><span class="n">pcm2_z1E</span><span class="o">-</span><span class="mi">04</span><span class="n">ps_DSF1E</span><span class="o">-</span><span class="mf">14_1E+02</span><span class="n">Vcm_h1E</span><span class="o">-</span><span class="mi">12</span><span class="n">_m1E</span><span class="o">+</span><span class="mi">00</span><span class="n">_rt12h_rv</span><span class="o">-</span><span class="mf">1E+02</span><span class="n">Vcm_c</span><span class="o">.</span><span class="n">png</span>
<span class="o">|</span>   <span class="o">|---</span> <span class="o">...</span>
<span class="o">|</span>   <span class="o">|---</span><span class="n">ofat_analysis</span><span class="o">.</span><span class="n">csv</span>
</pre></div>
</div>
<p>This is an example of a concentration plot</p>
<div class="figure align-center" id="id4">
<a class="reference internal image-reference" href="_images/constant_source_flux_96_85C_1E+10pcm2_z1E-04ps_DSF1E-16_1E+04Vcm_h1E-12_m1E+00_rt12h_rv-1E+04Vcm_c.png"><img alt="_images/constant_source_flux_96_85C_1E+10pcm2_z1E-04ps_DSF1E-16_1E+04Vcm_h1E-12_m1E+00_rt12h_rv-1E+04Vcm_c.png" src="_images/constant_source_flux_96_85C_1E+10pcm2_z1E-04ps_DSF1E-16_1E+04Vcm_h1E-12_m1E+00_rt12h_rv-1E+04Vcm_c.png" style="width: 400px;" /></a>
<p class="caption"><span class="caption-text">Example of a concentration plot from the batch analysis.</span><a class="headerlink" href="#id4" title="Permalink to this image">¶</a></p>
</div>
<p>This is an example of a <span class="math notranslate nohighlight">\(P_{\mathrm{mpp}}\)</span> plot</p>
<div class="figure align-center" id="id5">
<a class="reference internal image-reference" href="_images/constant_source_flux_96_85C_1E+10pcm2_z1E-04ps_DSF1E-16_1E+04Vcm_h1E-12_m1E+00_rt12h_rv-1E+04Vcm_p.png"><img alt="_images/constant_source_flux_96_85C_1E+10pcm2_z1E-04ps_DSF1E-16_1E+04Vcm_h1E-12_m1E+00_rt12h_rv-1E+04Vcm_p.png" src="_images/constant_source_flux_96_85C_1E+10pcm2_z1E-04ps_DSF1E-16_1E+04Vcm_h1E-12_m1E+00_rt12h_rv-1E+04Vcm_p.png" style="width: 400px;" /></a>
<p class="caption"><span class="caption-text">Example of a <span class="math notranslate nohighlight">\(P_{\mathrm{mpp}}\)</span> plot from the batch analysis.</span><a class="headerlink" href="#id5" title="Permalink to this image">¶</a></p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="pnptransport.html" class="btn btn-neutral float-right" title="Finite Source Simulation Code" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="index.html" class="btn btn-neutral float-left" title="Welcome to PNP Transport’s documentation!" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, Erick R Martinez Loran

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>